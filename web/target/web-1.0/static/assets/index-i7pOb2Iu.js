import{d as R,f as _,l as w,g as f,w as l,b as i,B,v as I,n as P,p as q,r as v,a as o,e as x,E as L,h as C,c as z,j as W,s as T,C as O,_ as V,m as N,o as X,D as A,G as $,H as D,q as U,J,t as j,u as G}from"./index-B2Hze045.js";import{u as H,a as K,_ as M,I as Q}from"./Form.vue_vue_type_script_setup_true_lang-CmOriPjR.js";import{s as Y,R as Z,A as ee}from"./chatUtil-oYKybORo.js";import{h as te}from"./request-cIyc3Ouv.js";import"./index-DBMBxV-i.js";const ae=R({__name:"ScheduleTypeChooser",props:{data:{},disabledParent:{type:Boolean},config:{}},setup(p){const n=p,{modelValue:e}=H(n);return(s,d)=>{const r=_("el-radio-button"),u=_("el-radio-group");return f(),w(K,{config:n.config,data:n.data},{default:l(()=>[i(u,{modelValue:I(e),"onUpdate:modelValue":d[0]||(d[0]=m=>B(e)?e.value=m:null)},{default:l(()=>[i(r,{label:"执行一次",value:"FIXED"}),i(r,{label:"周期执行",value:"SIMPLE"}),i(r,{label:"CRON",value:"CRON"})]),_:1},8,["modelValue"])]),_:1},8,["config","data"])}}}),ne={props:{labelWidth:"120px"},children:[{key:"mode",mode:"dynamic",size:1,label:"定时器类型",defaultVal:"FIXED",props:{component:ae}},{key:"fixedTime",mode:"datetimePicker",label:"执行时间",mandatory:!0,size:1,props:{},bindings:{show:"this.data.mode=='FIXED'"}},{key:"startTime",mode:"datetimePicker",label:"开始时间",size:1,props:{},bindings:{show:"this.data.mode!='FIXED'"}},{key:"endTime",mode:"datetimePicker",label:"结束时间",size:1,props:{},bindings:{show:"this.data.mode!='FIXED'"}},{key:"repeatInterval",mode:"input",label:"间隔",mandatory:!0,defaultVal:"10",size:1,props:{dataType:"number"},bindings:{show:"this.data.mode=='SIMPLE'"}},{key:"repeatUnit",mode:"select",label:"单位",mandatory:!0,defaultVal:"minute",size:1,props:{options:"hour:小时,minute:分,second:秒,milliSecond:毫秒"},bindings:{show:"this.data.mode=='SIMPLE'"}},{key:"repeatCount",mode:"inputNumber",label:"重复次数",description:`-1代表无限重复;\r
当设置为其他值时,实际执行次数为设置值+1`,mandatory:!0,defaultVal:"-1",size:1,props:{min:-1,precision:0},bindings:{show:"this.data.mode=='SIMPLE'"}},{key:"cronExpression",mode:"cron",label:"CRON表达式",mandatory:!1,size:1,bindings:{show:"this.data.mode=='CRON'"}}]},se={class:"dialog-footer"},oe=R({inheritAttrs:!1,__name:"TaskScheduleDialog",props:{modelValue:{},modelModifiers:{}},emits:P(["saved"],["update:modelValue"]),setup(p,{emit:n}){const e=q(p,"modelValue"),s=n,d=v(),r=v({}),u=async()=>{try{await d.value?.validate(),e.value=!1,s("saved",r.value)}catch{L.error("请检查表单填写是否正确")}};return(m,c)=>{const h=_("el-button"),b=_("el-dialog");return f(),w(b,{title:"任务定时设置",modelValue:e.value,"onUpdate:modelValue":c[1]||(c[1]=g=>e.value=g),width:"30%","append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:l(()=>[o("span",se,[i(h,{onClick:c[0]||(c[0]=g=>e.value=!1)},{default:l(()=>[...c[2]||(c[2]=[x("取 消",-1)])]),_:1}),i(h,{type:"primary",onClick:u},{default:l(()=>[...c[3]||(c[3]=[x("确 定",-1)])]),_:1})])]),default:l(()=>[i(M,{ref_key:"taskScheduleFormRef",ref:d,data:r.value,config:I(ne)},null,8,["data","config"])]),_:1},8,["modelValue"])}}}),le={class:"prompt-input"},ie={class:"content"},de={class:"input-section"},re={class:"editor-container"},ue={class:"actions"},ce=R({__name:"AgentRequestInput",props:{agentRuntime:{}},setup(p){const n=p,e=v({query:`获取数据后进行3阶多项式回归模型,重点展示拟合值和检测值的关系.生成CSV文件就可以,禁止生成报告.
自变量: 上游水位,下游水位,温度,检测日期
因变量: 杨压力
孔号: 节2-1 
结果发送到jamie0828@163.com`}),s=v(""),d=v(),r=C(()=>n.agentRuntime.status.value==="idle"),u=C(()=>n.agentRuntime.status.value==="executing"),m=C(()=>n.agentRuntime.status.value==="stopping"),c=async()=>{try{await d.value?.validate(),n.agentRuntime.sessionId.value?T.confirm("存在已经执行完成或失败的会话,是否启动新会话?","确认继续",{type:"warning"}).then(()=>{h()}):h()}catch(t){console.error("请检查表单填写是否正确",t),L.error("请检查表单填写是否正确")}},h=()=>{n.agentRuntime.sendRequestInput({taskName:s.value||n.agentRuntime.agent.value?.name,request:JSON.stringify(e.value)})},b=async()=>{await d.value?.validate();const t=v(!1);Q({"~":oe,"~modelValue":t,"@saved":function(E,y){g(y)}},O._context,{removeEvent:"close"}),t.value=!0},g=async t=>{const a={taskName:s.value||n.agentRuntime.agent.value?.name,request:JSON.stringify(e.value),agentId:n.agentRuntime.agentId.value,scheduler:JSON.stringify(t)};await te.post("/chat/scheduler",a),L.success("定时任务创建成功!请在定时任务里查看或停止.")},k=async()=>{await Y(n.agentRuntime.sessionId.value)};return(t,a)=>{const E=_("el-input"),y=_("el-button"),S=_("el-card");return f(),z("div",le,[i(S,{class:"chat-card"},{header:l(()=>[...a[1]||(a[1]=[o("div",{class:"card-header"},[o("h3",null,"请求信息")],-1)])]),default:l(()=>[o("div",ie,[o("div",de,[i(E,{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=F=>s.value=F),placeholder:"自定义任务名称,没有使用智能体名称",maxlength:"120","show-word-limit":""},null,8,["modelValue"])]),o("div",re,[i(M,{ref_key:"inputFormRef",ref:d,config:n.agentRuntime.agentInputConfig.value,data:e.value},null,8,["config","data"])]),o("div",ue,[r.value?(f(),w(y,{key:0,type:"primary",size:"large",onClick:c},{default:l(()=>[...a[2]||(a[2]=[x(" 开始执行 ",-1)])]),_:1})):W("",!0),r.value?(f(),w(y,{key:1,type:"primary",size:"large",onClick:b},{default:l(()=>[...a[3]||(a[3]=[x(" 定时执行 ",-1)])]),_:1})):W("",!0),u.value||m.value?(f(),w(y,{key:2,type:"danger",size:"large",onClick:k,loading:m.value,disabled:!1},{default:l(()=>[...a[4]||(a[4]=[x(" 停止执行 ",-1)])]),_:1},8,["loading"])):W("",!0)])])]),_:1})])}}}),me=V(ce,[["__scopeId","data-v-2cefdf27"]]),pe={class:"result-display"},fe=R({__name:"ResultDisplay",props:{agentRuntime:{}},setup(p){return(n,e)=>{const s=_("el-card");return f(),z("div",pe,[i(s,{class:"main-card"},{header:l(()=>[...e[0]||(e[0]=[o("div",{class:"main-header"},[o("div",{class:"query-info"},[o("span",{class:"query-text"},"执行结果")])],-1)])]),default:l(()=>[i(Z,{agentRuntime:n.agentRuntime},null,8,["agentRuntime"])]),_:1})])}}}),ve=V(fe,[["__scopeId","data-v-7b189734"]]),_e=R({__name:"index",props:{leftWidth:{default:30},minLeftWidth:{default:20},maxLeftWidth:{default:80},identifier:{default:"default"}},emits:["update:leftWidth"],setup(p,{emit:n}){const e=p,s=n,d=v(),r=v(!1),u=v(e.leftWidth),m=`resizablePanel_${e.identifier}`,c=()=>{try{const t=localStorage.getItem(m);if(t){const a=parseInt(t,10);!isNaN(a)&&a>=e.minLeftWidth&&a<=e.maxLeftWidth&&(u.value=a,s("update:leftWidth",u.value))}}catch(t){console.warn("Failed to load width from localStorage:",t)}},h=t=>{try{localStorage.setItem(m,t.toString())}catch(a){console.warn("Failed to save width to localStorage:",a)}};N(()=>e.leftWidth,t=>{u.value=t}),N(u,t=>{h(t)}),X(()=>{c()});const b=t=>{t.preventDefault(),r.value=!0,document.addEventListener("mousemove",g),document.addEventListener("mouseup",k),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},g=t=>{if(!r.value||!d.value)return;const a=d.value.getBoundingClientRect(),E=t.clientX-a.left,y=a.width,S=E/y*100;S>=e.minLeftWidth&&S<=e.maxLeftWidth&&(u.value=Math.round(S),s("update:leftWidth",u.value))},k=()=>{r.value=!1,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",k),document.body.style.cursor="",document.body.style.userSelect=""};return A(()=>{document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",k),document.body.style.cursor="",document.body.style.userSelect=""}),(t,a)=>(f(),z("div",{class:"resizable-panel",ref_key:"containerRef",ref:d},[o("div",{class:"left-panel",style:$({width:u.value+"%"})},[D(t.$slots,"left",{},void 0,!0)],4),o("div",{class:U(["resize-handle",{resizing:r.value}]),onMousedown:b},null,34),o("div",{class:"right-panel",style:$({width:100-u.value+"%"})},[D(t.$slots,"right",{},void 0,!0)],4)],512))}}),ge=V(_e,[["__scopeId","data-v-89519fca"]]),he={class:"agent-execute-container"},ye={class:"page-header"},Re={class:"page-title"},be={class:"main-content"},ke=R({__name:"index",setup(p){const n=J(),e=G(),s=new ee(n.params.agentId),d=()=>{e.push("/agent")};return(r,u)=>{const m=_("el-page-header");return f(),z("div",he,[o("div",ye,[i(m,{onBack:d,title:"返回"},{content:l(()=>[o("span",Re,j(I(s).agent.value?.name),1)]),_:1})]),o("div",be,[i(ge,{identifier:"agentExecuteMain","min-left-width":20,"max-left-width":80,"left-width":30},{left:l(()=>[i(me,{"agent-runtime":I(s)},null,8,["agent-runtime"])]),right:l(()=>[i(ve,{"agent-runtime":I(s)},null,8,["agent-runtime"])]),_:1})])])}}}),ze=V(ke,[["__scopeId","data-v-d881fc15"]]);export{ze as default};
