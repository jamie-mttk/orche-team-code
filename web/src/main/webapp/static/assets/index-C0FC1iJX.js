import{m as $}from"./index-9WU55kKR.js";import{d as B,c as V,a as i,t as w,b as l,e as C,I as T,w as r,i as L,f as y,j as E,g as f,_ as M,h as A,l as U,F as D,k as P,r as k,m as F,o as q,E as h,s as z}from"./index-B2vw2cJR.js";import{P as K}from"./index-CwSFDTK5.js";import"./request-BMGuovp_.js";const R={class:"card-header"},x={class:"model-info"},S={class:"model-name"},j={class:"model-meta"},H={class:"meta-item"},G={class:"card-actions"},J={class:"card-content"},O={class:"model-description"},Q={class:"model-config"},W={key:0,class:"config-item"},X={class:"config-value"},Y={key:1,class:"config-item"},Z={class:"config-value"},ee=B({__name:"ModelCard",props:{model:{}},emits:["edit","delete","click"],setup(N,{emit:u}){const m=N,n=u,a=e=>e?new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"}):"未知时间",o=e=>e>=1e3?(e/1e3).toFixed(1)+"K":e.toString(),_=()=>{n("click",m.model)},p=()=>{n("edit",m.model)},t=()=>{n("delete",m.model)};return(e,c)=>{const b=y("el-button");return f(),V("div",{class:"model-card",onClick:_},[i("div",R,[i("div",x,[i("h3",S,w(e.model.name),1),i("div",j,[i("span",H,[l(T,{name:"mdiClock",size:"small"}),C(" "+w(a(e.model._insertTime||e.model._updateTime)),1)])])]),i("div",G,[l(b,{type:"primary",size:"small",circle:"",onClick:L(p,["stop"])},{default:r(()=>[l(T,{name:"mdiPencil"})]),_:1}),l(b,{type:"danger",size:"small",circle:"",onClick:L(t,["stop"])},{default:r(()=>[l(T,{name:"mdiDelete"})]),_:1})])]),i("div",J,[i("p",O,w(e.model.description||"暂无描述"),1),i("div",Q,[e.model.modelName?(f(),V("div",W,[c[0]||(c[0]=i("span",{class:"config-label"},"模型:",-1)),i("span",X,w(e.model.modelName),1)])):E("",!0),e.model.maxTokens?(f(),V("div",Y,[c[1]||(c[1]=i("span",{class:"config-label"},"最大Token:",-1)),i("span",Z,w(o(e.model.maxTokens)),1)])):E("",!0)])])])}}}),te=M(ee,[["__scopeId","data-v-8536fbcc"]]),le={class:"model-list-view"},oe={class:"model-cards"},ae=B({__name:"ModelList",props:{models:{},searchName:{}},emits:["add","edit","delete","view","update:searchName"],setup(N){const u=N,m=A(()=>u.searchName?u.models.filter(n=>n.name.toLowerCase().includes(u.searchName.toLowerCase())):u.models);return(n,a)=>{const o=y("el-input"),_=y("el-empty");return f(),V("div",le,[l(K,{title:"模型列表",icon:"cog","show-add-button":!0,"add-button-text":"新增模型",onAdd:a[1]||(a[1]=p=>n.$emit("add"))},{content:r(()=>[l(o,{"model-value":n.searchName,"onUpdate:modelValue":a[0]||(a[0]=p=>n.$emit("update:searchName",p)),placeholder:"按名称搜索模型",style:{width:"300px"},clearable:""},{prefix:r(()=>[l(T,{name:"magnify"})]),_:1},8,["model-value"])]),_:1}),i("div",oe,[(f(!0),V(D,null,P(m.value,p=>(f(),U(te,{key:p._id||"",model:p,onEdit:a[2]||(a[2]=t=>n.$emit("edit",t)),onDelete:a[3]||(a[3]=t=>n.$emit("delete",t)),onClick:a[4]||(a[4]=t=>n.$emit("view",t))},null,8,["model"]))),128))]),m.value.length===0?(f(),U(_,{key:0,description:"暂无模型数据",class:"empty-state"})):E("",!0)])}}}),se=M(ae,[["__scopeId","data-v-40ad6782"]]),ne={class:"form-container"},ie={class:"form-header"},de=B({__name:"ModelForm",props:{model:{},isEdit:{type:Boolean},submitting:{type:Boolean}},emits:["submit","back"],setup(N,{emit:u}){const m=N,n=u,a=k(),o=k({name:"",description:"",apiBaseUrl:"",apiKey:"",modelName:"",maxTokens:65536,temperature:0,_id:void 0}),_={name:[{required:!0,message:"请输入模型名称",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}],apiBaseUrl:[{required:!0,message:"请输入API基础URL",trigger:"blur"},{type:"url",message:"请输入有效的URL地址",trigger:"blur"}],apiKey:[{required:!0,message:"请输入API密钥",trigger:"blur"}],modelName:[{required:!0,message:"请输入模型名称",trigger:"blur"}],maxTokens:[{required:!0,message:"请输入最大Token数",trigger:"blur"},{type:"number",min:1,message:"Token数必须大于0",trigger:"blur"}],temperature:[{required:!0,message:"请设置温度参数",trigger:"blur"},{type:"number",min:0,max:2,message:"温度参数必须在0-2之间",trigger:"blur"}]};F(()=>m.model,t=>{t?o.value={...t}:o.value={name:"",description:"",apiBaseUrl:"",apiKey:"",modelName:"",maxTokens:65536,temperature:0,_id:void 0}},{immediate:!0});const p=async()=>{if(a.value)try{await a.value.validate(),n("submit",o.value)}catch(t){console.error("表单验证失败:",t)}};return(t,e)=>{const c=y("el-button"),b=y("el-input"),g=y("el-form-item"),I=y("el-input-number"),d=y("el-slider"),v=y("el-form");return f(),V("div",ne,[i("div",ie,[i("h2",null,w(t.isEdit?"修改模型":"新增模型"),1),l(c,{onClick:e[0]||(e[0]=s=>t.$emit("back"))},{default:r(()=>[...e[9]||(e[9]=[C("返回列表",-1)])]),_:1})]),l(v,{ref_key:"formRef",ref:a,model:o.value,rules:_,"label-width":"120px",class:"model-form"},{default:r(()=>[l(g,{label:"模型名称",prop:"name"},{default:r(()=>[l(b,{modelValue:o.value.name,"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.name=s),placeholder:"请输入模型名称",disabled:t.submitting},null,8,["modelValue","disabled"])]),_:1}),l(g,{label:"模型描述",prop:"description"},{default:r(()=>[l(b,{modelValue:o.value.description,"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.description=s),type:"textarea",rows:3,placeholder:"请输入模型描述",disabled:t.submitting},null,8,["modelValue","disabled"])]),_:1}),l(g,{label:"API基础URL",prop:"apiBaseUrl"},{default:r(()=>[l(b,{modelValue:o.value.apiBaseUrl,"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.apiBaseUrl=s),placeholder:"请输入API基础URL，如：https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions",disabled:t.submitting},null,8,["modelValue","disabled"])]),_:1}),l(g,{label:"API密钥",prop:"apiKey"},{default:r(()=>[l(b,{modelValue:o.value.apiKey,"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.apiKey=s),type:"password",placeholder:"请输入API密钥",disabled:t.submitting,"show-password":""},null,8,["modelValue","disabled"])]),_:1}),l(g,{label:"模型名称",prop:"modelName"},{default:r(()=>[l(b,{modelValue:o.value.modelName,"onUpdate:modelValue":e[5]||(e[5]=s=>o.value.modelName=s),placeholder:"请输入模型名称，如：qwen-plus-2025-07-28",disabled:t.submitting},null,8,["modelValue","disabled"])]),_:1}),l(g,{label:"最大Token数",prop:"maxTokens"},{default:r(()=>[l(I,{modelValue:o.value.maxTokens,"onUpdate:modelValue":e[6]||(e[6]=s=>o.value.maxTokens=s),min:1,max:1e6,step:1e3,placeholder:"请输入最大Token数",disabled:t.submitting,style:{width:"100%"}},null,8,["modelValue","disabled"])]),_:1}),l(g,{label:"温度参数",prop:"temperature"},{default:r(()=>[l(d,{modelValue:o.value.temperature,"onUpdate:modelValue":e[7]||(e[7]=s=>o.value.temperature=s),min:0,max:2,step:.1,disabled:t.submitting,"show-input":"","input-size":"large","format-tooltip":s=>s.toFixed(1)},null,8,["modelValue","disabled","format-tooltip"]),e[10]||(e[10]=i("div",{class:"slider-description"},[i("span",{class:"description-text"},"0.0: 确定性输出，2.0: 创造性输出")],-1))]),_:1}),l(g,null,{default:r(()=>[l(c,{type:"primary",onClick:p,loading:t.submitting,size:"large"},{default:r(()=>[C(w(t.isEdit?"保存修改":"新增模型"),1)]),_:1},8,["loading"]),l(c,{onClick:e[8]||(e[8]=s=>t.$emit("back")),size:"large",disabled:t.submitting},{default:r(()=>[...e[11]||(e[11]=[C("取消",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])}}}),re=M(de,[["__scopeId","data-v-3e6309e2"]]),me={class:"model-management-page"},ue=B({__name:"index",setup(N){const u=k(!1),m=k(!1),n=k(!1),a=k(),o=k(""),_=k([]),p=async()=>{try{const d=await $.searchModels();_.value=d.data.list||[]}catch(d){console.error("加载模型列表失败:",d),h.error("加载模型列表失败"),_.value=[]}},t=()=>{m.value=!1,a.value=void 0,u.value=!0},e=d=>{m.value=!0,a.value=d,u.value=!0},c=()=>{u.value=!1,m.value=!1,a.value=void 0},b=async d=>{try{if(n.value=!0,m.value){const v={...d,_id:a.value?._id};await $.saveModel(v),h.success("修改成功")}else await $.saveModel(d),h.success("新增成功");c(),p()}catch(v){console.error("保存失败:",v),h.error("保存失败")}finally{n.value=!1}},g=async d=>{try{await z.confirm(`确定要删除模型 "${d.name}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),d._id&&await $.deleteModel(d._id),h.success("删除成功"),p()}catch(v){v!=="cancel"&&(console.error("删除失败:",v),h.error("删除失败"))}},I=d=>{h.info(`查看模型: ${d.name}`)};return q(()=>{p()}),(d,v)=>(f(),V("div",me,[u.value?(f(),U(re,{key:1,model:a.value,"is-edit":m.value,submitting:n.value,onSubmit:b,onBack:c},null,8,["model","is-edit","submitting"])):(f(),U(se,{key:0,models:_.value,"search-name":o.value,onAdd:t,onEdit:e,onDelete:g,onView:I,"onUpdate:searchName":v[0]||(v[0]=s=>o.value=s)},null,8,["models","search-name"]))]))}}),be=M(ue,[["__scopeId","data-v-37da4203"]]);export{be as default};
