import{s as V,a as C}from"./index-CJGsZFYU.js";import{P as U}from"./index-BkCG6ryb.js";import{d as q,A as H,r as g,o as j,c as f,b as a,a as l,w as s,f as r,I as d,e as T,F as G,k as L,t as z,E as i,s as O,g as _,_ as J}from"./index-FPnQycga.js";import"./request-DQlLT5HJ.js";const K={class:"system-config-page"},Q={class:"config-content"},W={class:"card-header"},X={class:"card-header"},Y={class:"tag-list"},Z={key:0,class:"empty-state"},ee={key:1,class:"tag-items"},ae={class:"tag-content"},te={class:"tag-name"},se={class:"tag-actions"},oe=q({__name:"index",setup(le){const p=H({_id:"",httpPort:7474,_insertTime:"",_updateTime:""}),y=g(!1),v=g([]),c=g(!1),m=g(!1),w=g(!1),x=g(),n=H({_id:"",name:""}),B={name:[{required:!0,message:"请输入标签名称",trigger:"blur"},{min:1,max:20,message:"标签名称长度在1到20个字符",trigger:"blur"}]},S=async()=>{try{const e=(await V.getSystemConfig()).data;Object.assign(p,e)}catch(t){console.error("加载HTTP配置失败:",t),i.error("加载HTTP配置失败")}},A=async()=>{try{y.value=!0,await V.saveSystemConfig(p),i.success("HTTP配置保存成功")}catch(t){console.error("保存HTTP配置失败:",t),i.error("保存HTTP配置失败")}finally{y.value=!1}},h=async()=>{try{const t=await C.queryTags();v.value=t.data.list||[]}catch(t){console.error("加载智能体标签失败:",t),i.error("加载智能体标签失败"),v.value=[]}},D=()=>{m.value=!1,n._id="",n.name="",c.value=!0},E=t=>{m.value=!0,n._id=t._id,n.name=t.name,c.value=!0},F=async()=>{try{await x.value.validate(),w.value=!0;const t={name:n.name};m.value&&(t._id=n._id),await C.saveTag(t),i.success(m.value?"标签更新成功":"标签添加成功"),c.value=!1,h()}catch(t){t!==!1&&(console.error("保存标签失败:",t),i.error("保存标签失败"))}finally{w.value=!1}},I=async t=>{try{await O.confirm(`确定要删除标签 "${t.name}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await C.deleteTag(t._id),i.success("标签删除成功"),h()}catch(e){e!=="cancel"&&(console.error("删除标签失败:",e),i.error("删除标签失败"))}};return j(()=>{S(),h()}),(t,e)=>{const u=r("el-button"),$=r("el-input-number"),P=r("el-form-item"),k=r("el-form"),b=r("el-card"),M=r("el-input"),N=r("el-dialog");return _(),f("div",K,[a(U,{title:"系统配置",icon:"cog"}),l("div",Q,[a(b,{class:"config-card",shadow:"hover"},{header:s(()=>[l("div",W,[a(d,{name:"mdiGlobe",size:"medium",class:"card-icon"}),e[5]||(e[5]=l("span",{class:"card-title"},"HTTP配置",-1)),a(u,{type:"primary",size:"small",onClick:A,loading:y.value},{default:s(()=>[a(d,{name:"mdiContentSave"}),e[4]||(e[4]=T(" 保存 ",-1))]),_:1},8,["loading"])])]),default:s(()=>[a(k,{model:p,"label-width":"100px",class:"config-form"},{default:s(()=>[a(P,{label:"HTTP端口"},{default:s(()=>[a($,{modelValue:p.httpPort,"onUpdate:modelValue":e[0]||(e[0]=o=>p.httpPort=o),min:1,max:65535,placeholder:"请输入HTTP端口",style:{width:"200px"}},null,8,["modelValue"]),e[6]||(e[6]=l("span",{class:"form-tip"},"端口范围:1-65535",-1))]),_:1})]),_:1},8,["model"])]),_:1}),a(b,{class:"config-card",shadow:"hover"},{header:s(()=>[l("div",X,[a(d,{name:"mdiTag",size:"medium",class:"card-icon"}),e[8]||(e[8]=l("span",{class:"card-title"},"智能体标签",-1)),a(u,{type:"primary",size:"small",onClick:D},{default:s(()=>[a(d,{name:"mdiPlus"}),e[7]||(e[7]=T(" 新增 ",-1))]),_:1})])]),default:s(()=>[l("div",Y,[v.value.length===0?(_(),f("div",Z,[a(d,{name:"mdiTag",size:"large",class:"empty-icon"}),e[9]||(e[9]=l("p",null,"暂无标签，点击上方按钮添加标签",-1))])):(_(),f("div",ee,[(_(!0),f(G,null,L(v.value,o=>(_(),f("div",{key:o._id,class:"tag-item"},[l("div",ae,[l("span",te,z(o.name),1)]),l("div",se,[a(u,{size:"small",plain:"",onClick:R=>E(o)},{default:s(()=>[a(d,{name:"mdiPencil",size:"small"})]),_:2},1032,["onClick"]),a(u,{size:"small",type:"danger",plain:"",onClick:R=>I(o)},{default:s(()=>[a(d,{name:"mdiDelete",size:"small"})]),_:2},1032,["onClick"])])]))),128))]))])]),_:1})]),a(N,{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=o=>c.value=o),title:m.value?"编辑标签":"新增标签",width:"400px","close-on-click-modal":!1},{footer:s(()=>[a(u,{onClick:e[2]||(e[2]=o=>c.value=!1)},{default:s(()=>[...e[10]||(e[10]=[T("取消",-1)])]),_:1}),a(u,{type:"primary",onClick:F,loading:w.value},{default:s(()=>[T(z(m.value?"更新":"保存"),1)]),_:1},8,["loading"])]),default:s(()=>[a(k,{model:n,rules:B,ref_key:"tagFormRef",ref:x,"label-width":"80px"},{default:s(()=>[a(P,{label:"标签名称",prop:"name"},{default:s(()=>[a(M,{modelValue:n.name,"onUpdate:modelValue":e[1]||(e[1]=o=>n.name=o),placeholder:"请输入标签名称",maxlength:"20","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ce=J(oe,[["__scopeId","data-v-6ce23119"]]);export{ce as default};
