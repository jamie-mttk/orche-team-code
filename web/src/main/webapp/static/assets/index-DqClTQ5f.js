import{m as $}from"./index-CaYEjiCe.js";import{d as B,c as N,a as s,t as h,b as o,e as C,I as U,w as r,i as K,f as _,j as L,g as f,_ as I,h as A,l as M,F as D,k as P,r as k,m as x,o as F,E as V,s as q}from"./index-BEaTRiqt.js";import{P as z}from"./index-kk8ZeESb.js";import"./request-D85rebqp.js";const R={class:"card-header"},S={class:"model-info"},j={class:"model-name"},H={class:"model-meta"},G={class:"meta-item"},J={class:"card-actions"},O={class:"card-content"},Q={class:"model-description"},W={class:"model-config"},X={key:0,class:"config-item"},Y={class:"config-value"},Z={key:1,class:"config-item"},ee={class:"config-value"},te=B({__name:"ModelCard",props:{model:{}},emits:["edit","delete","click"],setup(T,{emit:u}){const m=T,n=u,a=e=>e?new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"}):"未知时间",l=e=>e>=1024?(e/1024).toFixed(0)+"K":e.toString(),b=()=>{n("click",m.model)},p=()=>{n("edit",m.model)},c=()=>{n("delete",m.model)};return(e,t)=>{const y=_("el-button");return f(),N("div",{class:"model-card",onClick:b},[s("div",R,[s("div",S,[s("h3",j,h(e.model.name),1),s("div",H,[s("span",G,[o(U,{name:"mdiClock",size:"small"}),C(" "+h(a(e.model._insertTime||e.model._updateTime)),1)])])]),s("div",J,[o(y,{type:"primary",size:"small",circle:"",onClick:K(p,["stop"])},{default:r(()=>[o(U,{name:"mdiPencil"})]),_:1}),o(y,{type:"danger",size:"small",circle:"",onClick:K(c,["stop"])},{default:r(()=>[o(U,{name:"mdiDelete"})]),_:1})])]),s("div",O,[s("p",Q,h(e.model.description||"暂无描述"),1),s("div",W,[e.model.modelName?(f(),N("div",X,[t[0]||(t[0]=s("span",{class:"config-label"},"模型:",-1)),s("span",Y,h(e.model.modelName),1)])):L("",!0),e.model.maxTokens?(f(),N("div",Z,[t[1]||(t[1]=s("span",{class:"config-label"},"最大Token:",-1)),s("span",ee,h(l(e.model.maxTokens)),1)])):L("",!0)])])])}}}),oe=I(te,[["__scopeId","data-v-99274a55"]]),le={class:"model-list-view"},ae={class:"model-cards"},se=B({__name:"ModelList",props:{models:{},searchName:{}},emits:["add","edit","delete","view","update:searchName"],setup(T){const u=T,m=A(()=>u.searchName?u.models.filter(n=>n.name.toLowerCase().includes(u.searchName.toLowerCase())):u.models);return(n,a)=>{const l=_("el-input"),b=_("el-empty");return f(),N("div",le,[o(z,{title:"模型列表",icon:"cog","show-add-button":!0,"add-button-text":"新增模型",onAdd:a[1]||(a[1]=p=>n.$emit("add"))},{content:r(()=>[o(l,{"model-value":n.searchName,"onUpdate:modelValue":a[0]||(a[0]=p=>n.$emit("update:searchName",p)),placeholder:"按名称搜索模型",style:{width:"300px"},clearable:""},{prefix:r(()=>[o(U,{name:"magnify"})]),_:1},8,["model-value"])]),_:1}),s("div",ae,[(f(!0),N(D,null,P(m.value,p=>(f(),M(oe,{key:p._id||"",model:p,onEdit:a[2]||(a[2]=c=>n.$emit("edit",c)),onDelete:a[3]||(a[3]=c=>n.$emit("delete",c)),onClick:a[4]||(a[4]=c=>n.$emit("view",c))},null,8,["model"]))),128))]),m.value.length===0?(f(),M(b,{key:0,description:"暂无模型数据",class:"empty-state"})):L("",!0)])}}}),ne=I(se,[["__scopeId","data-v-40ad6782"]]),ie={class:"form-container"},de={class:"form-header"},re={class:"slider-description"},me={class:"description-text"},ue=B({__name:"ModelForm",props:{model:{},isEdit:{type:Boolean},submitting:{type:Boolean}},emits:["submit","back"],setup(T,{emit:u}){const m=T,n=u,a=k(),l=k({name:"",description:"",apiBaseUrl:"",apiKey:"",modelName:"",maxTokens:65536,temperature:0,_id:void 0}),b=A({get:()=>Math.round((l.value.maxTokens??65536)/1024),set:e=>{l.value.maxTokens=e*1024}}),p={name:[{required:!0,message:"请输入模型名称",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}],apiBaseUrl:[{required:!0,message:"请输入API基础URL",trigger:"blur"},{type:"url",message:"请输入有效的URL地址",trigger:"blur"}],apiKey:[{required:!0,message:"请输入API密钥",trigger:"blur"}],modelName:[{required:!0,message:"请输入模型名称",trigger:"blur"}],maxTokens:[{required:!0,message:"请输入最大Token数",trigger:"blur"},{type:"number",min:1,message:"Token数必须大于0",trigger:"blur"}],temperature:[{required:!0,message:"请设置温度参数",trigger:"blur"},{type:"number",min:0,max:2,message:"温度参数必须在0-2之间",trigger:"blur"}]};x(()=>m.model,e=>{e?l.value={...e}:l.value={name:"",description:"",apiBaseUrl:"",apiKey:"",modelName:"",maxTokens:65536,temperature:0,_id:void 0}},{immediate:!0});const c=async()=>{if(a.value)try{await a.value.validate(),n("submit",l.value)}catch(e){console.error("表单验证失败:",e)}};return(e,t)=>{const y=_("el-button"),w=_("el-input"),g=_("el-form-item"),i=_("el-input-number"),v=_("el-slider"),E=_("el-form");return f(),N("div",ie,[s("div",de,[s("h2",null,h(e.isEdit?"修改模型":"新增模型"),1),o(y,{onClick:t[0]||(t[0]=d=>e.$emit("back"))},{default:r(()=>[...t[9]||(t[9]=[C("返回列表",-1)])]),_:1})]),o(E,{ref_key:"formRef",ref:a,model:l.value,rules:p,"label-width":"120px",class:"model-form"},{default:r(()=>[o(g,{label:"模型名称",prop:"name"},{default:r(()=>[o(w,{modelValue:l.value.name,"onUpdate:modelValue":t[1]||(t[1]=d=>l.value.name=d),placeholder:"请输入模型名称",disabled:e.submitting},null,8,["modelValue","disabled"])]),_:1}),o(g,{label:"模型描述",prop:"description"},{default:r(()=>[o(w,{modelValue:l.value.description,"onUpdate:modelValue":t[2]||(t[2]=d=>l.value.description=d),type:"textarea",rows:3,placeholder:"请输入模型描述",disabled:e.submitting},null,8,["modelValue","disabled"])]),_:1}),o(g,{label:"API基础URL",prop:"apiBaseUrl"},{default:r(()=>[o(w,{modelValue:l.value.apiBaseUrl,"onUpdate:modelValue":t[3]||(t[3]=d=>l.value.apiBaseUrl=d),placeholder:"请输入API基础URL，如：https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions",disabled:e.submitting},null,8,["modelValue","disabled"])]),_:1}),o(g,{label:"API密钥",prop:"apiKey"},{default:r(()=>[o(w,{modelValue:l.value.apiKey,"onUpdate:modelValue":t[4]||(t[4]=d=>l.value.apiKey=d),type:"password",placeholder:"请输入API密钥",disabled:e.submitting,"show-password":""},null,8,["modelValue","disabled"])]),_:1}),o(g,{label:"模型名称",prop:"modelName"},{default:r(()=>[o(w,{modelValue:l.value.modelName,"onUpdate:modelValue":t[5]||(t[5]=d=>l.value.modelName=d),placeholder:"请输入模型名称，如：qwen-plus-2025-07-28",disabled:e.submitting},null,8,["modelValue","disabled"])]),_:1}),o(g,{label:"最大Token数",prop:"maxTokens"},{default:r(()=>[o(i,{modelValue:b.value,"onUpdate:modelValue":t[6]||(t[6]=d=>b.value=d),min:1,max:976,step:1,placeholder:"请输入最大Token数（K）",disabled:e.submitting,style:{width:"100%"}},null,8,["modelValue","disabled"]),s("div",re,[s("span",me,"以K为单位（1K = 1024 Token），实际值："+h((l.value.maxTokens??0).toLocaleString()),1)])]),_:1}),o(g,{label:"温度参数",prop:"temperature"},{default:r(()=>[o(v,{modelValue:l.value.temperature,"onUpdate:modelValue":t[7]||(t[7]=d=>l.value.temperature=d),min:0,max:2,step:.1,disabled:e.submitting,"show-input":"","input-size":"large","format-tooltip":d=>d.toFixed(1)},null,8,["modelValue","disabled","format-tooltip"]),t[10]||(t[10]=s("div",{class:"slider-description"},[s("span",{class:"description-text"},"0.0: 确定性输出，2.0: 创造性输出")],-1))]),_:1}),o(g,null,{default:r(()=>[o(y,{type:"primary",onClick:c,loading:e.submitting,size:"large"},{default:r(()=>[C(h(e.isEdit?"保存修改":"新增模型"),1)]),_:1},8,["loading"]),o(y,{onClick:t[8]||(t[8]=d=>e.$emit("back")),size:"large",disabled:e.submitting},{default:r(()=>[...t[11]||(t[11]=[C("取消",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])}}}),pe=I(ue,[["__scopeId","data-v-a94b5565"]]),ce={class:"model-management-page"},ve=B({__name:"index",setup(T){const u=k(!1),m=k(!1),n=k(!1),a=k(),l=k(""),b=k([]),p=async()=>{try{const i=await $.searchModels();b.value=i.data.list||[]}catch(i){console.error("加载模型列表失败:",i),V.error("加载模型列表失败"),b.value=[]}},c=()=>{m.value=!1,a.value=void 0,u.value=!0},e=i=>{m.value=!0,a.value=i,u.value=!0},t=()=>{u.value=!1,m.value=!1,a.value=void 0},y=async i=>{try{if(n.value=!0,m.value){const v={...i,_id:a.value?._id};await $.saveModel(v),V.success("修改成功")}else await $.saveModel(i),V.success("新增成功");t(),p()}catch(v){console.error("保存失败:",v),V.error("保存失败")}finally{n.value=!1}},w=async i=>{try{await q.confirm(`确定要删除模型 "${i.name}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),i._id&&await $.deleteModel(i._id),V.success("删除成功"),p()}catch(v){v!=="cancel"&&(console.error("删除失败:",v),V.error("删除失败"))}},g=i=>{V.info(`查看模型: ${i.name}`)};return F(()=>{p()}),(i,v)=>(f(),N("div",ce,[u.value?(f(),M(pe,{key:1,model:a.value,"is-edit":m.value,submitting:n.value,onSubmit:y,onBack:t},null,8,["model","is-edit","submitting"])):(f(),M(ne,{key:0,models:b.value,"search-name":l.value,onAdd:c,onEdit:e,onDelete:w,onView:g,"onUpdate:searchName":v[0]||(v[0]=E=>l.value=E)},null,8,["models","search-name"]))]))}}),ye=I(ve,[["__scopeId","data-v-37da4203"]]);export{ye as default};
