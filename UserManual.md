# OrcheTeam 用户手册


## 目录结构


| 目录 | 功能说明 |
|------|----------|
| `bin` | 系统启动和管理脚本，包含 startup、shutdown、init 等脚本以及服务安装工具 |
| `conf` | 系统配置文件目录，存放环境配置、日志配置、MongoDB配置、Quartz调度配置等 |
| `data` | 数据存储目录 |
| `lib` | 系统核心库文件目录，禁止用户修改 |
| `lib_user` | 用户自定义库目录，可存放用户开发的智能体插件和第三方依赖库. addon存放用户开发的智能体,portable存放第三方依赖库,java.library.path指向native目录,存放加载本地库文件（如.dll或.so文件) |
| `log` | 系统日志文件目录，按日期组织日志文件 |
| `temp` | 临时文件目录，每次重启自动删除 |
| `web` | Web 应用部署目录，包含系统管理界面的 WAR 包 |

## 第三方库部署

为了访问数据库,需要加入对应的JDBC驱动.可以放到目录lib_user\portable,也可以在下面建立子目录更好的组织.
重启后第三方库生效.

## 界面

### 1. 首页 

提供一些快捷方式到其他页面.

### 2. 智能体

管理(增删改)智能体,运行智能体.下面是一些需要注意

#### **互联网搜索**
需要 Serper API Key，可访问 https://serper.dev 注册，免费赠送额度足够使用很长时间.Serper实现根据关键字查询网页.后续会支持更多类型的API.
主要处理步骤如下
- 生成关键字列表   第一次根据用户问题,后续根据上一次查询结果的欠缺内容.通过调用大模型实现.
- 网页查询        根据关键字获取网页(标题,链接,简介)
- 网页下载        下载网页并智能的转换成文本.智能是指试图忽略掉可能的广告和菜单等,试图得到核心的内容.忽略掉下载失败,内容太小和太大的网页.
- 网页汇总        整理上一步获得网页调用大模型得到markdown格式的汇总. 由于模型上下文最大令牌数限制,尝试过多种方式,以后会开放用户选择不同的汇总方式.当前实现为调用两次大模型,第一次给出所有网页(标题,简介和部分内容)让大模型结合最大令牌数选择合适的网页,第二步提交第一步结果生成汇总.
- 如果汇总结果不满足需求,循环以上所有步骤.根据测试,尝试太多次数没有价值,因为有的信息互联网可能根本就搜索不到.

##### **React智能体**
ReAct智能体核心在于系统提示词和下一步提示词.执行逻辑为循环执行,最大循环次数由参数最大轮次给出.第一次执行提交给大模型 系统提示词+用户问题+工具列表,根据反馈结果执行工具;后续执行提交 历史对话记录+下一步提示词+工具列表,根据反馈执行工具.直到没有任何工具需要执行.

系统提示词和下一步提示词有如下方式设置
 - 先规划后执行 先做一个计划,然后逐步执行;如果执行有问题,重新规划
 - 边规划边执行 分析用户问题后开始执行工具,每次执行完评估后调用下一个工具
 - 智能生成     用户在系统提示词区域输入规划方案,如"先做规划然后执行,出错后退出",点击"智能生成"后系统调用大模型生成系统提示词和下一步提示词
 - 手工输入    建议在上面三种方式(特别是前两种方式)基础上修改

遇到的问题

 - 大模型偶尔会调用错误的工具,此问题我们后续会做优化.
 - 先规划后执行有时候模型不会给出规划结果直接调用工具.

 #### 数据库查询
首先需要参考第三方库部署加入JDBC 驱动
支持增加多个表后,让系统生成系统提示词.
当然用户也可以手工修改提示词以便生成更加准确的SQL.
最佳实现是在数据库里的表备注,字段备注中给出合适的描述.

#### MCP
MCP推荐使用HTTP方式,标准输入输出方式当前为每次调用都启动MCP Server.后续会优化,支持多种方式控制MCP Server数量.  
获取到的MCP工具列表,建议只保留需要的,以减少令牌使用量和降低大模型选择工具的难度.  
为了让大模型更好的理解工具以及参数作用,允许用户修改工具描述和参数描述(当前允许用户修改整个参数,修改错误会导致调用失败).  
MCP的缺陷个人觉得有:1 - 缺少对于工具的配置,当前只能通过环境变量方式实现.HTTP方式隐含可以通过key之类的参数映射到服务器的配置 2 - 没有给出返回值的描述.  
如果测试,可以使用高德地图MCP,MCP地址 https://mcp.amap.com/mcp ,调用key参考  https://lbs.amap.com/api/mcp-server/create-project-and-key

### 文件上传
ReAct智能体等都可以上传文件.上传的文件会存到到暂存区,智能体执行开始后会加入到智能体执行上下文中供后续工具调用,如生成报告.

建议为文件增加描述,这样大模型能够更好的理解文件包含的内容.

### 流程执行
流程执行完成后点击根节点会查看到所有的文件.

### 3. 任务
任务查询和回放.
回放会快速回顾任务执行过程,节点后现实时间为实际执行时间.

### 4. 大模型设置
设置大模型.
当前测试过阿里天问和DeepSeek V3(官方API和硅基流动API)  
理论上只要是支持Funciton Calling的都可以支持.后续我们会测试其他大模型,但是当前时间人手不够!  
建议使用 最大Token数 大的模型,如qwen-plus-2025-07-28,原因前面有介绍.

### 4. 定时 
管理(删除)定时任务.

### 5. 部署管理 (Deploy Management)
用于部署用户开发的智能体.步骤如下
 - 拷贝打包后的jar以及相关文件到 lib_user\addon
 - 重启Orche Team
 - 部署界面上传打包后的jar
 - 如果没有报错可直接在智能体界面选择和使用


### 6. 系统配置 (System Configuration)

#### HTTP配置
配置管理界面HTTP端口,保存后立刻起效
#### 智能体标签
增删改


